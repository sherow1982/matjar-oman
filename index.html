<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>متجر عمان</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: "Cairo", sans-serif; margin: 0; padding: 0; background-color: #f9f9f9; color: #333; }
        .container { width: 90%; max-width: 1200px; margin: 0 auto; }
        .navbar { background-color: #fff; padding: 1rem 0; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .brand { font-size: 1.8rem; font-weight: bold; color: #333; text-decoration: none; }
        .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 25px; padding: 40px 0; }
        .product-card { background-color: #fff; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); padding: 20px; text-align: center; }
        .product-card img { max-width: 100%; height: 200px; object-fit: cover; border-radius: 8px; }
        .price { font-size: 1.5rem; font-weight: bold; color: #28a745; }
        .old-price { color: #999; text-decoration: line-through; }
        .buttons-container { margin-top: 15px; }
        .btn { cursor: pointer; border-radius: 50px; border: none; padding: 10px 18px; font-size: 0.9rem; font-weight: bold; margin: 4px; text-decoration: none; display: inline-block; }
        .whatsapp-btn { background-color: #25D366; color: white; }
        .details-btn, .buy-now-btn { background-color: #007bff; color: white; }
        .modal { display: none; position: fixed; z-index: 1001; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.5); }
        .modal-content { background-color: #fff; margin: 5% auto; padding: 30px; border-radius: 10px; width: 90%; max-width: 600px; position: relative; }
        .close { color: #aaa; position: absolute; left: 25px; top: 15px; font-size: 28px; font-weight: bold; cursor: pointer; }
        .modal img { width: 100%; max-height: 300px; object-fit: contain; }
        .reviews-section { margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px; text-align: right; }
        .review-item { border-bottom: 1px solid #eee; padding: 10px 0; }
        .review-stars { color: gold; font-size: 18px; }
    </style>
</head>
<body>
    <header class="navbar">
        <div class="container">
            <a href="#" class="brand">متجر عمان</a>
        </div>
    </header>
    <main class="container">
        <div id="product-grid" class="product-grid"></div>
        <div id="modal-container"></div>
    </main>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const jsonUrl = 'https://raw.githubusercontent.com/sherow1982/matjar-oman/main/products.json';
            
            fetch(jsonUrl)
                .then(response => response.json())
                .then(products => {
                    const productGrid = document.getElementById('product-grid');
                    const modalContainer = document.getElementById('modal-container');

                    products.forEach((product, index) => {
                        // Create Product Card
                        const card = document.createElement('div');
                        card.className = 'product-card';
                        card.innerHTML = `
                            <img src="${product['رابط الصورة']}" alt="${product.العنوان}">
                            <h3>${product.العنوان}</h3>
                            <p class="price">${product['ﺎﻠﺴﻋﺭ ﺎﻠﻤﺨﻔَّﺿ']} <span class="old-price">${product['ﺎﻠﺴﻋﺭ'] || ''}</span></p>
                            <div class="buttons-container">
                                <button class="btn whatsapp-btn" onclick="openWhatsApp('${product.العنوان}', '${product['ﺎﻠﺴﻋﺭ ﺎﻠﻤﺨﻔَّﺿ']}')">واتساب</button>
                                <button class="btn details-btn" onclick="openModal(${index})">تفاصيل المنتج</button>
                                <a href="${product.الرابط}" target="_blank" class="btn buy-now-btn">اشتريه الآن</a>
                            </div>
                        `;
                        productGrid.appendChild(card);

                        // Create Modal for Product Details
                        const modal = document.createElement('div');
                        modal.id = `modal-${index}`;
                        modal.className = 'modal';
                        modal.innerHTML = `
                            <div class="modal-content">
                                <span class="close" onclick="closeModal(${index})">&times;</span>
                                <h2>${product.العنوان}</h2>
                                <img src="${product['رابط الصورة']}" alt="${product.العنوان}">
                                <p>${product.الوصف.replace(/\\n/g, '<br>')}</p>
                                <div class="buttons-container">
                                    <a href="${product.الرابط}" target="_blank" class="btn buy-now-btn">اشتريه الآن من المتجر الأصلي</a>
                                </div>
                                <div class="reviews-section">
                                    <h3>تقييمات المشترين</h3>
                                    ${generateReviews()}
                                </div>
                            </div>
                        `;
                        modalContainer.appendChild(modal);
                    });
                })
                .catch(error => {
                    document.getElementById('product-grid').innerHTML = '<p>حدث خطأ في تحميل المنتجات.</p>';
                    console.error('Error:', error);
                });
        });

        function openWhatsApp(productName, price) {
            const phoneNumber = '+201110760081'; // !!! قم بتغيير هذا الرقم
            const message = encodeURIComponent(`أهلاً، أرغب في طلب المنتج التالي:\n\n*المنتج:* ${productName}\n*السعر:* ${price}`);
            window.open(`https://wa.me/${phoneNumber}?text=${message}`, '_blank');
        }

        function openModal(index) {
            document.getElementById(`modal-${index}`).style.display = 'block';
        }

        function closeModal(index) {
            document.getElementById(`modal-${index}`).style.display = 'none';
        }

        function generateReviews() {
            const reviews = [
                "والله منتج فنان وحل لي مشكلة كبيرة. أنصحكم فيه وبقوة.",
                "ما شاء الله على الجودة، صراحة فرق عن بو فالسوق. يستاهل كل ريال.",
                "حبيته واجد، عملي ومفيد فالبيت. كل حد يسألني عنه."
            ];
            let reviewsHtml = '';
            for (let i = 0; i < 2; i++) {
                const rating = Math.floor(Math.random() * 2) + 4; // 4 or 5 stars
                reviewsHtml += `
                    <div class="review-item">
                        <div class="review-stars">${'&#9733;'.repeat(rating)}${'&#9734;'.repeat(5 - rating)}</div>
                        <p><strong>مشتري موثوق</strong></p>
                        <p>${reviews[Math.floor(Math.random() * reviews.length)]}</p>
                    </div>
                `;
            }
            return reviewsHtml;
        }

        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = "none";
            }
        }
    </script>
</body>
</html>
